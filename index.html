<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Caso 02 — Yachay Tech Solutions S.A.C. (Sistema Interactivo)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<style>
  /* ---------- Tipografía y Reset ---------- */
  @font-face {
    font-family: InterVar;
    src: local("Arial");
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html,body { height: 100%; }
  body {
    font-family: InterVar, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: linear-gradient(180deg,#040714 0%, #071029 60%, #091724 100%);
    color:#e6eef8;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow: auto;
  }

  /* ---------- Layout ---------- */
  .app {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 24px;
    min-height: 100vh;
    padding: 28px;
  }

  /* ---------- Sidebar ---------- */
  .sidebar {
    background: linear-gradient(180deg, rgba(4,12,36,0.6), rgba(3,18,40,0.45));
    border-radius: 16px;
    padding: 22px;
    box-shadow: 0 8px 30px rgba(2,8,20,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    border: 1px solid rgba(80,200,255,0.06);
    position: sticky;
    top: 28px;
    height: calc(100vh - 56px);
    display:flex;
    flex-direction:column;
    gap:18px;
  }

  .brand {
    display:flex; gap:12px; align-items:center;
  }
  .logo {
    width:56px; height:56px; border-radius:12px;
    background: linear-gradient(135deg,#00f0ff,#007cff);
    box-shadow: 0 6px 18px rgba(0,140,255,0.16);
    display:flex; align-items:center; justify-content:center;
    font-weight:700; color:#021024; font-size:20px;
  }
  .brand h1 { font-size:1.05rem; color:#cfeeff; }
  .brand p { font-size:0.78rem; color:#9fcfff; margin-top:3px; opacity:0.9; }

  .nav {
    display:flex; flex-direction:column; gap:8px; margin-top:12px;
  }
  .nav button {
    display:flex; align-items:center; gap:12px;
    background:transparent; border:none; color: #bfe9ff;
    padding:10px; border-radius:10px; cursor:pointer; text-align:left;
    transition: all .22s ease;
    font-weight:600;
  }
  .nav button:hover { transform: translateX(6px); color:#fff; }
  .nav button.active {
    background: linear-gradient(90deg, rgba(0,160,255,0.12), rgba(0,120,200,0.06));
    box-shadow: 0 8px 24px rgba(0,120,255,0.06);
    color:#eaffff;
  }

  .nav svg { width:20px; height:20px; opacity:0.95; }

  .side-footer {
    margin-top:auto;
    font-size:0.78rem; color:#98d2ff; opacity:0.9;
  }

  /* ---------- Main Panel ---------- */
  .panel {
    border-radius: 16px;
    padding: 26px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: 0 12px 40px rgba(2,8,20,0.6);
    border: 1px solid rgba(255,255,255,0.03);
    min-height: calc(100vh - 56px);
  }

  /* header inside panel */
  .panel-header {
    display:flex; justify-content:space-between; align-items:center; gap:20px; margin-bottom:20px;
  }
  .panel-header .title {
    font-size:1.45rem; font-weight:800; letter-spacing:0.3px; color:#bff2ff;
  }
  .panel-header .subtitle { color:#9fcfff; font-size:0.9rem; margin-top:4px; }

  /* action pills */
  .pills { display:flex; gap:10px; align-items:center; flex-wrap: wrap; }
  .pill { 
    padding:8px 12px; 
    background: rgba(255,255,255,0.02); 
    border-radius:999px; 
    color:#bfe9ff; 
    font-weight:700; 
    border:1px solid rgba(0,160,255,0.06); 
    cursor:pointer; 
    transition:transform .18s;
    font-size: 0.85rem;
  }
  .pill:hover { transform:translateY(-3px); box-shadow: 0 8px 20px rgba(0,120,255,0.06); }
  .pill.active { background: rgba(0,200,255,0.2); border-color: rgba(0,200,255,0.4); }

  /* ---------- Content Box ---------- */
  .card {
    margin-top:10px; background: linear-gradient(180deg, rgba(8,20,36,0.45), rgba(8,20,28,0.3));
    padding:18px; border-radius:12px; border: 1px solid rgba(120,220,255,0.03);
  }

  /* collapsible items */
  .accordion { margin-top:12px; display:flex; flex-direction:column; gap:10px; }
  .acc-item { background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03)); border-radius:10px; overflow:hidden; border:1px solid rgba(255,255,255,0.02); }
  .acc-head {
    display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 16px; cursor:pointer;
    transition: background .18s ease, transform .12s ease;
  }
  .acc-head:hover { background: linear-gradient(90deg, rgba(0,160,255,0.03), rgba(0,120,255,0.02)); transform: translateY(-2px); }
  .acc-title { font-weight:800; color:#dff9ff; }
  .acc-sub { font-weight:600; color:#9fd6ff; font-size:0.9rem; opacity:0.95; }
  .acc-body { padding:0 18px 18px 18px; color:#d6eefb; font-size:0.95rem; line-height:1.6; display:none; }

  /* animated + icon */
  .chev { width:28px; height:28px; border-radius:8px; display:flex; align-items:center; justify-content:center; background: linear-gradient(180deg, rgba(0,140,255,0.16), rgba(0,80,220,0.12)); color:#dffaff; transition: transform 0.18s; }

  /* ---------- FODA MATRIX ---------- */
  .foda-wrap {
    margin-top:18px;
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:14px;
  }

  .foda-card {
    background: linear-gradient(180deg, rgba(6,15,30,0.5), rgba(2,8,20,0.35));
    border-radius:12px;
    padding:18px;
    border: 1px solid rgba(80,200,255,0.035);
    overflow:hidden;
    position:relative;
  }
  .foda-card h4 { margin-bottom:8px; color:#cfeeff; font-size:1.02rem; }
  .foda-card p, .foda-card li { color:#d0ecff; opacity:0.95; margin-bottom:6px; }
  .foda-grid {
    display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top:16px;
  }

  /* Matrix big */
  .matrix {
    margin-top:18px;
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
    border-radius:12px;
    overflow:hidden;
  }
  .matrix .cell {
    min-height:160px; padding:18px; background: linear-gradient(180deg, rgba(3,10,20,0.45), rgba(3,10,20,0.22));
    border-left: 4px solid rgba(0,200,255,0.08);
    transition: transform .18s ease, box-shadow .2s ease;
    position:relative;
  }
  .cell:hover { transform: translateY(-6px); box-shadow: 0 18px 50px rgba(0,140,255,0.06); }
  .cell h5 { color:#bff6ff; margin-bottom:8px; font-weight:800; }
  .cell ul { margin-left:16px; list-style: none; padding-left:0; }
  .cell ul li { padding:6px 0; color:#dff7ff; }

  /* badges */
  .badge {
    display:inline-block; padding:6px 10px; border-radius:999px; font-weight:800; font-size:0.78rem; color:#00131b;
    background: linear-gradient(90deg,#b3f4ff,#58bfff);
    box-shadow: 0 8px 24px rgba(80,200,255,0.06);
    margin-left:6px;
  }

  /* ---------- micro helpers ---------- */
  .muted { color:#8fbfe4; font-size:0.92rem; }
  .small { font-size:0.86rem; color:#9cc9e8; }
  .kpi-row { display:flex; gap:14px; margin-top:12px; flex-wrap:wrap; }
  .kpi { padding:8px 12px; background:rgba(255,255,255,0.02); border-radius:10px; font-weight:700; color:#dffbff; }

  /* NUEVAS FUNCIONALIDADES - Editable */
  .editable {
    position: relative;
    padding: 2px;
    border-radius: 4px;
    transition: background 0.2s;
  }
  
  .edit-mode .editable:hover {
    background: rgba(0,200,255,0.08);
    cursor: text;
    outline: 1px dashed rgba(0,200,255,0.3);
  }

  .editable[contenteditable="true"] {
    outline: 2px solid rgba(0,200,255,0.5);
    background: rgba(0,200,255,0.06);
  }

  /* NUEVAS FUNCIONALIDADES - Métricas */
  .metrics-panel {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 14px;
    margin-top: 16px;
  }

  .metric-input {
    background: linear-gradient(180deg, rgba(0,100,200,0.12), rgba(0,50,150,0.06));
    padding: 14px;
    border-radius: 10px;
    border: 1px solid rgba(100,200,255,0.12);
  }

  .metric-input label {
    display: block;
    font-size: 0.85rem;
    color: #9fcfff;
    margin-bottom: 6px;
    font-weight: 600;
  }

  .metric-input input {
    width: 100%;
    padding: 8px 12px;
    background: rgba(0,0,0,0.3);
    border: 1px solid rgba(100,200,255,0.2);
    border-radius: 6px;
    color: #dffbff;
    font-size: 1rem;
    font-weight: 700;
  }

  .metric-input input:focus {
    outline: none;
    border-color: rgba(0,200,255,0.5);
    box-shadow: 0 0 0 3px rgba(0,200,255,0.1);
  }

  .charts-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 20px;
  }

  .chart-container {
    background: linear-gradient(180deg, rgba(8,20,36,0.45), rgba(8,20,28,0.3));
    padding: 20px;
    border-radius: 12px;
    border: 1px solid rgba(120,220,255,0.03);
  }

  .chart-container h4 {
    color: #cfeeff;
    margin-bottom: 12px;
    font-size: 1.1rem;
  }

  canvas {
    max-height: 300px;
  }

  /* responsive */
  @media (max-width:980px) {
    .app { grid-template-columns: 1fr; padding:18px; }
    .sidebar { position:relative; height:auto; top:0; }
    .charts-grid { grid-template-columns: 1fr; }
  }
  @media (max-width:640px) {
    .metrics-panel { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
  <div class="app" id="appRoot">
    <!-- SIDEBAR -->
    <aside class="sidebar" aria-label="Navegación principal">
      <div class="brand">
        <div class="logo">YT</div>
        <div>
          <h1>Yachay Tech</h1>
          <p>CASO 02 — Sistema Interactivo</p>
        </div>
      </div>

      <nav class="nav" role="navigation" aria-label="Secciones">
        <button id="btn-home" class="active" data-show="home">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 12l9-7 9 7v7a2 2 0 0 1-2 2h-4v-6H9v6H5a2 2 0 0 1-2-2z"/></svg>
          Resumen
        </button>

        <button id="btn-21" data-show="sec-21">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 7v10a2 2 0 0 0 2 2h14V7H3z"/><path d="M7 7V5a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2"/></svg>
          2.1 — Caso práctico (Fases)
        </button>

        <button id="btn-22" data-show="sec-22">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
          2.2 — FODA TI (Matriz)
        </button>

        <button id="btn-metrics" data-show="metrics">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 3v18h18"/><path d="M18 17l-4-4-4 4-4-8"/></svg>
          📊 Métricas y Gráficos
        </button>

        <button id="btn-download" data-show="download">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          Descargar (PDF)
        </button>
      </nav>

      <div class="side-footer small">
        <div><strong>Estado:</strong> Proyecto piloto — 8 meses</div>
        <div style="margin-top:8px;"><strong>Autor:</strong> Equipo Yachay Tech</div>
      </div>
    </aside>

    <!-- PANEL PRINCIPAL -->
    <main class="panel" id="mainPanel" role="main">
      <div class="panel-header">
        <div>
          <div class="title editable" contenteditable="false">CASO 02 — Yachay Tech Solutions S.A.C.</div>
          <div class="subtitle editable" contenteditable="false">Gestión del cambio, seguridad de la información y matriz FODA TI — interactivo</div>
        </div>

        <div class="pills">
          <div class="pill" id="toggle-edit">✏️ Editar</div>
          <div class="pill" id="save-data">💾 Guardar</div>
          <div class="pill" id="pill-1">Interfaz dinámica</div>
        </div>
      </div>

      <!-- HOME / SUMMARY -->
      <section id="home" class="card" aria-labelledby="btn-home">
        <div style="display:flex; justify-content:space-between; gap:12px; align-items:center; flex-wrap:wrap;">
          <div>
            <h3 style="color:#dffcff; margin-bottom:6px;" class="editable" contenteditable="false">Resumen ejecutivo</h3>
            <p class="muted editable" contenteditable="false">Programa Integrado de Transformación Digital Segura para Yachay Tech: seguridad, mejora continua y gestión del conocimiento para proyectos IA y Cloud.</p>
          </div>
          <div>
            <div class="kpi-row">
              <div class="kpi editable" contenteditable="false">Objetivo: Reducción incidentes 75%</div>
              <div class="kpi editable" contenteditable="false">Estandarización: 90%</div>
              <div class="kpi editable" contenteditable="false">Retención técnica: +30%</div>
            </div>
          </div>
        </div>

        <div style="margin-top:16px;" class="accordion">
          <div class="acc-item">
            <div class="acc-head" data-target="quick-fases"><div><div class="acc-title editable" contenteditable="false">2.1 — Caso práctico (rápido)</div><div class="acc-sub editable" contenteditable="false">Fases principales y timeline</div></div><div class="chev">➤</div></div>
            <div class="acc-body" id="quick-fases">
              <div class="editable" contenteditable="false">
              <strong>Fase 0 — Diagnóstico:</strong> Incidentes cloud, documentación dispersa, dependencia de seniors.<br>
              <strong>Fase 1 — Gobernanza:</strong> Comité y políticas ISO 27001, mejora continua.<br>
              <strong>Fase 2 — Planificación:</strong> Inventario activos, riesgos y métricas (MTTR, SLA).<br>
              <strong>Fase 3 — Diseño:</strong> MFA, RBAC, DRP, Wiki, mentoring.<br>
              <strong>Fase 4 — Piloto:</strong> Mes 1–8 (controles, wiki, simulacros).<br>
              <strong>Fase 5 — Medición:</strong> KPIs, auditorías y reporte trimestral.
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="quick-foda"><div><div class="acc-title editable" contenteditable="false">2.2 — FODA TI (rápido)</div><div class="acc-sub editable" contenteditable="false">Sintesis FO/FA/DO/DA</div></div><div class="chev">➤</div></div>
            <div class="acc-body" id="quick-foda">
              <div class="editable" contenteditable="false">
              FO: Innovación + alianzas para expandir IA y Cloud.<br>
              FA: Fortalecer SGSI, SOC y retención de talento.<br>
              DO: Implementar ITSM y repositorio de conocimiento.<br>
              DA: Nube híbrida, cross-training y automatización SOC.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 2.1 Detailed -->
      <section id="sec-21" class="card" style="display:none;" aria-labelledby="btn-21">
        <h3 style="color:#bff6ff; margin-bottom:8px;" class="editable" contenteditable="false">2.1 — Caso práctico por fases</h3>
        <p class="small editable" contenteditable="false">Empresa: <strong>Yachay Tech Solutions S.A.C.</strong> — Sector: IA, Cloud & Ciberseguridad — Tamaño: 200 colaboradores.</p>

        <div class="accordion" style="margin-top:14px;">
          <div class="acc-item">
            <div class="acc-head" data-target="obj21"><div><div class="acc-title editable" contenteditable="false">🎯 Objetivo general</div><div class="acc-sub editable" contenteditable="false">Programa Integrado de Transformación Digital Segura</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="obj21">
              <div class="editable" contenteditable="false">
              Implementar un Programa Integrado de Transformación Digital Segura (PITDS) que fortalezca la seguridad de la información, promueva la mejora continua en la gestión de proyectos TI y fomente la transferencia del conocimiento técnico.
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="f0-21"><div><div class="acc-title editable" contenteditable="false">Fase 0 — Contexto y diagnóstico inicial</div><div class="acc-sub editable" contenteditable="false">Problemas, impacto y actores</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="f0-21">
              <div class="editable" contenteditable="false">
              <ul>
                <li><strong>Problemas:</strong> incidentes de seguridad cloud por malas configuraciones; documentación inconsistente; dependencia de ingenieros senior; falta de métricas unificadas.</li>
                <li><strong>Impacto:</strong> vulnerabilidades, retrasos en entregas y menor satisfacción del cliente.</li>
                <li><strong>Actores:</strong> Gerente General, Jefe de TI, CISO, Líder de Innovación, RR.HH., Data Science, DevOps.</li>
              </ul>
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="f1-21"><div><div class="acc-title editable" contenteditable="false">Fase 1 — Alcance y gobernanza</div><div class="acc-sub editable" contenteditable="false">Comité, alcance y políticas</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="f1-21">
              <div class="editable" contenteditable="false">
              <ul>
                <li><strong>Alcance:</strong> Áreas de desarrollo, IA y Cloud (8 meses).</li>
                <li><strong>Comité:</strong> Sponsor (Gerente General), Líder del Proyecto (Jefe TI), Seguridad, RR.HH. y Operaciones.</li>
                <li><strong>Políticas:</strong> SGSI (ISO 27001), Gestión del Conocimiento y Mejora Continua (PDCA).</li>
              </ul>
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="f2-21"><div><div class="acc-title editable" contenteditable="false">Fase 2 — Planificación</div><div class="acc-sub editable" contenteditable="false">Inventario, riesgos y métricas</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="f2-21">
              <div class="editable" contenteditable="false">
              <ul>
                <li><strong>Inventario:</strong> servidores cloud (AWS/Azure), DB, repositorios Git, pipelines CI/CD, APIs, documentación, backups.</li>
                <li><strong>Riesgos:</strong> fuga de datos, configuraciones inseguras, vulnerabilidades en pipelines, pérdida de know-how.</li>
                <li><strong>Métricas iniciales:</strong> incidentes/t, MTTR, % entregas sin fallos, rotación técnica.</li>
              </ul>
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="f3-21"><div><div class="acc-title editable" contenteditable="false">Fase 3 — Diseño de soluciones</div><div class="acc-sub editable" contenteditable="false">Seguridad, Mejora Continua, Conocimiento</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="f3-21">
              <div class="editable" contenteditable="false">
              <strong>Seguridad:</strong> SGSI (ISO 27001), MFA, RBAC, pruebas pentest semestrales, backups diarios con replicación y plan IRP con simulacros trimestrales.<br><br>
              <strong>Mejora continua:</strong> PDCA aplicado a sprints; OKRs trimestrales, métricas (SonarQube, Jira, PowerBI); post-mortems en cada sprint.<br><br>
              <strong>Gestión del conocimiento:</strong> Wiki corporativa (Wiki Yachay), política documental obligatoria, programa de mentoría técnico y Tech Fridays.
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="f4-21"><div><div class="acc-title editable" contenteditable="false">Fase 4 — Implementación piloto</div><div class="acc-sub editable" contenteditable="false">Timeline Mes 1–8</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="f4-21">
              <div class="editable" contenteditable="false">
              <ul>
                <li><strong>Mes 1–2:</strong> Controles RBAC, MFA, backups, comité SGSI.</li>
                <li><strong>Mes 3–4:</strong> Lanzamiento Wiki Yachay, formaciones y tableros KPI.</li>
                <li><strong>Mes 5–6:</strong> Simulacros IRP, pruebas pentest y ajustes.</li>
                <li><strong>Mes 7–8:</strong> Evaluación, lecciones aprendidas y despliegue completo.</li>
              </ul>
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="f5-21"><div><div class="acc-title editable" contenteditable="false">Fase 5 — Medición y mejora</div><div class="acc-sub editable" contenteditable="false">KPIs y auditorías</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="f5-21">
              <div class="editable" contenteditable="false">
              <ul>
                <li>Auditorías internas y revisiones mensuales de KPIs.</li>
                <li>Encuestas internas y a clientes para medir satisfacción y mejora.</li>
                <li>Revisión anual del SGSI y actualizaciones del plan de continuidad.</li>
              </ul>
              </div>
            </div>
          </div>

          <div class="acc-item">
            <div class="acc-head" data-target="res-21"><div><div class="acc-title editable" contenteditable="false">Resultados esperados</div><div class="acc-sub editable" contenteditable="false">Impactos cuantificables</div></div><div class="chev">▸</div></div>
            <div class="acc-body" id="res-21">
              <div class="editable" contenteditable="false">
              <ul>
                <li>Reducción de incidentes en ~75% en el primer año.</li>
                <li>Estandarización de procesos en 90% de proyectos.</li>
                <li>Reducción de rotación técnica en 30% mediante mentoría y documentación.</li>
                <li>Mejora en cumplimiento SLA en 20% y satisfacción de cliente +25%.</li>
              </ul>
              </div>
            </div>
          </div>

        </div>
      </section>

      <!-- 2.2 FODA (visual, interactive matrix) -->
      <section id="sec-22" class="card" style="display:none;" aria-labelledby="btn-22">
        <h3 style="color:#bff6ff; margin-bottom:6px;" class="editable" contenteditable="false">2.2 — FODA TI (Matriz interactiva)</h3>
        <p class="muted editable" contenteditable="false">Haz clic en cada cuadrante para desplegar estrategias detalladas. El diseño visual está inspirado en el arquetipo FODA TI.</p>

        <div style="display:flex; gap:14px; margin-top:14px; align-items:flex-start;">
          <!-- left: legend & controls -->
          <div style="width:28%; min-width:220px;">
            <div class="card" style="padding:14px; border-radius:12px;">
              <h4 style="color:#cfeeff;" class="editable" contenteditable="false">Leyenda</h4>
              <p class="small editable" contenteditable="false">FO: Fortalezas vs Oportunidades — Estrategias ofensivas</p>
              <p class="small editable" contenteditable="false">FA: Fortalezas vs Amenazas — Estrategias defensivas</p>
              <p class="small editable" contenteditable="false">DO: Debilidades vs Oportunidades — Estrategias adaptativas</p>
              <p class="small editable" contenteditable="false">DA: Debilidades vs Amenazas — Estrategias de supervivencia</p>

              <div style="margin-top:12px;">
                <button class="pill" data-show-cell="fo">Abrir FO</button>
                <button class="pill" data-show-cell="fa">Abrir FA</button>
                <button class="pill" data-show-cell="do">Abrir DO</button>
                <button class="pill" data-show-cell="da">Abrir DA</button>
              </div>
            </div>

            <div class="card" style="margin-top:12px;">
              <h4 style="color:#cfeeff;" class="editable" contenteditable="false">KPIs sugeridos</h4>
              <ul style="margin-top:8px; color:#dff7ff;">
                <li class="editable" contenteditable="false">% procesos documentados</li>
                <li class="editable" contenteditable="false">MTTR (Tiempo medio restauración)</li>
                <li class="editable" contenteditable="false">Tasa de retención de talento clave</li>
                <li class="editable" contenteditable="false">Nuevos contratos de servicios gestionados</li>
              </ul>
            </div>
          </div>

          <!-- right: matrix -->
          <div style="flex:1;">
            <div class="matrix" id="matrix">
              <div class="cell" id="cell-fo" style="border-left-color: #00e6ff;">
                <h5 class="editable" contenteditable="false">🟩 FORTALEZAS vs OPORTUNIDADES (FO)</h5>
                <ul>
                  <li class="editable" contenteditable="false"><strong>Oportunidades:</strong> Inversión en IA, programas estatales, mercado regional.</li>
                  <li class="editable" contenteditable="false"><strong>Fortalezas:</strong> Certificaciones, infraestructura cloud, equipo IA.</li>
                  <li style="margin-top:8px;" class="editable" contenteditable="false"><span class="badge">E01</span> Expandir IA con cofinanciamiento.</li>
                  <li class="editable" contenteditable="false"><span class="badge">E02</span> Servicios regionales Cloud.</li>
                  <li class="editable" contenteditable="false"><span class="badge">E03</span> Alianzas I+D con universidades.</li>
                </ul>
              </div>

              <div class="cell" id="cell-fa" style="border-left-color: #ff8a8a;">
                <h5 class="editable" contenteditable="false">🟥 FORTALEZAS vs AMENAZAS (FA)</h5>
                <ul>
                  <li class="editable" contenteditable="false"><strong>Amenazas:</strong> Competencia global, APTs, cambios regulatorios.</li>
                  <li class="editable" contenteditable="false"><strong>Fortalezas:</strong> SGSI, SOC 24/7, reputación.</li>
                  <li style="margin-top:8px;" class="editable" contenteditable="false"><span class="badge" style="background:#ffb3b3">E04</span> Programas de retención y formación.</li>
                  <li class="editable" contenteditable="false"><span class="badge" style="background:#ffb3b3">E05</span> Potenciar SOC y detección temprana.</li>
                  <li class="editable" contenteditable="false"><span class="badge" style="background:#ffb3b3">E06</span> Reforzar cumplimiento normativo.</li>
                </ul>
              </div>

              <div class="cell" id="cell-do" style="border-left-color: #ffd36b;">
                <h5 class="editable" contenteditable="false">🟨 DEBILIDADES vs OPORTUNIDADES (DO)</h5>
                <ul>
                  <li class="editable" contenteditable="false"><strong>Debilidades:</strong> Documentación dispersa, dependencia de expertos.</li>
                  <li class="editable" contenteditable="false"><strong>Oportunidades:</strong> Fondos de capacitación, herramientas open-source.</li>
                  <li style="margin-top:8px;" class="editable" contenteditable="false"><span class="badge" style="background:#ffe6b3">E07</span> Implementar ITSM y base documental.</li>
                  <li class="editable" contenteditable="false"><span class="badge" style="background:#ffe6b3">E08</span> CI/CD y automatización de despliegues.</li>
                  <li class="editable" contenteditable="false"><span class="badge" style="background:#ffe6b3">E09</span> Repositorio conjunto universidad-empresa.</li>
                </ul>
              </div>

              <div class="cell" id="cell-da" style="border-left-color: #bdb7ff;">
                <h5 class="editable" contenteditable="false">⬛ DEBILIDADES vs AMENAZAS (DA)</h5>
                <ul>
                  <li class="editable" contenteditable="false"><strong>Amenazas:</strong> APTs, fuga de talento, inestabilidad</li>
                  <li class="editable" contenteditable="false"><strong>Debilidades:</strong> Falta de redundancia, manuales faltantes</li>
                  <li style="margin-top:8px;" class="editable" contenteditable="false"><span class="badge" style="background:#d9ccff">E10</span> Nube híbrida y redundancia regional.</li>
                  <li class="editable" contenteditable="false"><span class="badge" style="background:#d9ccff">E11</span> Cross-training y planes de sucesión.</li>
                  <li class="editable" contenteditable="false"><span class="badge" style="background:#d9ccff">E12</span> Automatización de alertas y respuesta SOC.</li>
                </ul>
              </div>
            </div>

            <!-- expanded details area -->
            <div id="foda-details" class="card" style="margin-top:14px; display:none;">
              <h4 style="color:#cfeeff" class="editable" contenteditable="false">Detalle de la estrategia</h4>
              <div id="foda-detail-body" style="margin-top:10px; color:#cfeeff; line-height:1.6;"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- NUEVA SECCIÓN: MÉTRICAS Y GRÁFICOS -->
      <section id="metrics" class="card" style="display:none;">
        <h3 style="color:#bff6ff; margin-bottom:6px;">📊 Panel de Métricas y Gráficos Dinámicos</h3>
        <p class="muted">Ingresa valores numéricos y observa cómo se actualizan los gráficos en tiempo real</p>

        <div class="metrics-panel">
          <div class="metric-input">
            <label>Incidentes de Seguridad</label>
            <input type="number" class="metric-field" data-metric="incidents" value="45" min="0">
          </div>
          <div class="metric-input">
            <label>Proyectos Completados</label>
            <input type="number" class="metric-field" data-metric="projects" value="32" min="0">
          </div>
          <div class="metric-input">
            <label>Satisfacción Cliente (%)</label>
            <input type="number" class="metric-field" data-metric="satisfaction" value="87" min="0" max="100">
          </div>
          <div class="metric-input">
            <label>Tiempo Respuesta (hrs)</label>
            <input type="number" class="metric-field" data-metric="response" value="4.5" step="0.1" min="0">
          </div>
          <div class="metric-input">
            <label>Documentación (%)</label>
            <input type="number" class="metric-field" data-metric="docs" value="65" min="0" max="100">
          </div>
          <div class="metric-input">
            <label>Retención Talento (%)</label>
            <input type="number" class="metric-field" data-metric="retention" value="78" min="0" max="100">
          </div>
          <div class="metric-input">
            <label>Automatización (%)</label>
            <input type="number" class="metric-field" data-metric="automation" value="55" min="0" max="100">
          </div>
          <div class="metric-input">
            <label>Cumplimiento SLA (%)</label>
            <input type="number" class="metric-field" data-metric="sla" value="92" min="0" max="100">
          </div>
        </div>

        <div class="charts-grid">
          <div class="chart-container">
            <h4>📊 Distribución de Métricas Clave (%)</h4>
            <canvas id="pieChart"></canvas>
          </div>
          <div class="chart-container">
            <h4>📈 Indicadores de Rendimiento</h4>
            <canvas id="barChart"></canvas>
          </div>
        </div>
      </section>

      <!-- DOWNLOAD (simple export) -->
      <section id="download" class="card" style="display:none;">
        <h3 style="color:#bff6ff;">Exportar contenido</h3>
        <p class="small">Genera un PDF básico con el contenido visible (navegador, impresión). Para un PDF profesional te puedo generar Word/PPT separado.</p>
        <div style="margin-top:12px;">
          <button class="pill" id="btn-print">Generar PDF (Imprimir)</button>
          <button class="pill" id="btn-export-json">Exportar JSON</button>
        </div>
        <pre id="exportJsonArea" style="display:none; margin-top:12px; background:rgba(0,0,0,0.25); padding:12px; border-radius:8px; color:#cfeeff; max-height:260px; overflow:auto;"></pre>
      </section>

    </main>
  </div>

<script>
  let editMode = false;
  let pieChart = null;
  let barChart = null;
  const metricsData = {
    incidents: 45,
    projects: 32,
    satisfaction: 87,
    response: 4.5,
    docs: 65,
    retention: 78,
    automation: 55,
    sla: 92
  };

  // ---------- Navigation actions ----------
  document.querySelectorAll('.nav button').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');

      const show = btn.dataset.show;
      document.querySelectorAll('main .card, main section').forEach(s => s.style.display = 'none');

      if (show === 'home') {
        document.getElementById('home').style.display = 'block';
      } else if (show === 'sec-21') {
        document.getElementById('sec-21').style.display = 'block';
      } else if (show === 'sec-22') {
        document.getElementById('sec-22').style.display = 'block';
      } else if (show === 'metrics') {
        document.getElementById('metrics').style.display = 'block';
        if (!pieChart) setTimeout(initCharts, 100);
      } else if (show === 'download') {
        document.getElementById('download').style.display = 'block';
      }
      document.getElementById('foda-details') && (document.getElementById('foda-details').style.display='none');
    });
  });

  document.getElementById('home').style.display = 'block';

  // ---------- Accordion toggles ----------
  document.querySelectorAll('.acc-head').forEach(h=>{
    h.addEventListener('click', ()=>{
      const targ = h.dataset.target;
      const body = document.getElementById(targ);
      if (!body) return;
      const open = body.style.display === 'block';
      const parent = h.closest('.accordion');
      if (parent) {
        parent.querySelectorAll('.acc-body').forEach(b=>b.style.display='none');
        parent.querySelectorAll('.chev').forEach(c=>c.style.transform='rotate(0deg)');
      }
      if (!open) {
        body.style.display = 'block';
        const chev = h.querySelector('.chev');
        if (chev) { chev.style.transform = 'rotate(90deg)'; }
      } else {
        body.style.display = 'none';
      }
    });
  });

  // ---------- FODA interactive ----------
  function fodaDetailHtml(key) {
    const map = {
      'fo': `<strong>FO — Estrategias Ofensivas</strong><br>
      <p>Acciones prioritarias: (E01) Acceder a cofinanciamientos públicos y convocatorias para proyectos IA; (E02) empaquetar servicios cloud regionales con SLA competitivos; (E03) establecer acuerdos de I+D con universidades para talent pool y prototipos.</p>
      <ul><li>Responsable: Lider de Innovación / Jefe TI</li><li>Plazo: 3-6 meses (paquetes mínimos)</li><li>KPI: #proyectos cofinanciados, % ingresos nuevos</li></ul>`,
      'fa': `<strong>FA — Estrategias Defensivas</strong><br>
      <p>Acciones prioritarias: (E04) Programa de retención - certificaciones pagadas y planes de carrera; (E05) ampliar capacidades SOC (detección EDR + threat intel); (E06) auditorías trimestrales de cumplimiento.</p>
      <ul><li>Responsable: CISO / RR.HH.</li><li>Plazo: 1-12 meses (formación continua)</li><li>KPI: tasa de rotación, SLA de respuesta ante incidentes</li></ul>`,
      'do': `<strong>DO — Estrategias Adaptativas</strong><br>
      <p>Acciones prioritarias: (E07) Implementar ITSM/CMDB y regla documental obligatoria; (E08) automatizar pipelines CI/CD y despliegues canary; (E09) programas de colaboración universidad-empresa con intercambio de prácticas.</p>
      <ul><li>Responsable: Jefe DevOps / Líder Arquitectura</li><li>Plazo: 3-9 meses</li><li>KPI: % procesos documentados, % despliegues automatizados</li></ul>`,
      'da': `<strong>DA — Estrategias de Supervivencia</strong><br>
      <p>Acciones prioritarias: (E10) Diseñar arquitectura híbrida para redundancia regional y backups; (E11) implementar cross-training y planes de sucesión; (E12) automatizar respuesta SOC (playbooks) y orquestación SOAR.</p>
      <ul><li>Responsable: CTO / CISO</li><li>Plazo: 3-12 meses</li><li>KPI: RTO/RPO, tiempo medio de detección (MTTD)</li></ul>`
    };
    return map[key] || '';
  }

  document.querySelectorAll('#matrix .cell').forEach(cell=>{
    cell.style.cursor='pointer';
    cell.addEventListener('click', ()=> {
      const id = cell.id.split('-')[1];
      const details = document.getElementById('foda-details');
      const body = document.getElementById('foda-detail-body');
      body.innerHTML = fodaDetailHtml(id);
      details.style.display='block';
      details.scrollIntoView({behavior:'smooth', block:'center'});
      document.querySelectorAll('#matrix .cell').forEach(c => c.style.borderLeftWidth='4px');
      cell.style.borderLeftWidth='8px';
      cell.style.boxShadow='0 30px 70px rgba(0,160,255,0.08)';
    });
  });

  document.querySelectorAll('[data-show-cell]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const key = b.dataset.showCell;
      const el = document.getElementById('cell-'+key);
      el && el.click();
    });
  });

  // ---------- NUEVA FUNCIONALIDAD: Modo Edición ----------
  document.getElementById('toggle-edit').addEventListener('click', function() {
    editMode = !editMode;
    document.body.classList.toggle('edit-mode', editMode);
    
    document.querySelectorAll('.editable').forEach(el => {
      el.contentEditable = editMode;
    });

    this.classList.toggle('active', editMode);
    this.textContent = editMode ? '🔓 Editando...' : '✏️ Editar';
  });

  // ---------- NUEVA FUNCIONALIDAD: Guardar ----------
  document.getElementById('save-data').addEventListener('click', function() {
    const content = {};
    document.querySelectorAll('.editable').forEach((el, i) => {
      content[`elem_${i}`] = el.innerHTML;
    });
    
    const data = {
      content: content,
      metrics: metricsData,
      timestamp: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `yachay-data-${Date.now()}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    const orig = this.textContent;
    this.textContent = '✅ Guardado!';
    this.style.background = 'rgba(0,255,100,0.2)';
    setTimeout(() => {
      this.textContent = orig;
      this.style.background = '';
    }, 2000);
  });

  // ---------- NUEVA FUNCIONALIDAD: Gráficos ----------
  function initCharts() {
    const ctxPie = document.getElementById('pieChart');
    const ctxBar = document.getElementById('barChart');
    if (!ctxPie || !ctxBar) return;

    pieChart = new Chart(ctxPie, {
      type: 'pie',
      data: {
        labels: ['Satisfacción', 'Documentación', 'Retención', 'Automatización'],
        datasets: [{
          data: [metricsData.satisfaction, metricsData.docs, metricsData.retention, metricsData.automation],
          backgroundColor: ['rgba(0,255,150,0.7)', 'rgba(0,200,255,0.7)', 'rgba(150,100,255,0.7)', 'rgba(255,200,0,0.7)'],
          borderColor: ['rgba(0,255,150,1)', 'rgba(0,200,255,1)', 'rgba(150,100,255,1)', 'rgba(255,200,0,1)'],
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: { position: 'bottom', labels: { color: '#dffbff', font: { size: 11 } } }
        }
      }
    });

    barChart = new Chart(ctxBar, {
      type: 'bar',
      data: {
        labels: ['Incidentes', 'Proyectos', 'Tiempo Resp.', 'SLA'],
        datasets: [{
          label: 'Valores',
          data: [metricsData.incidents, metricsData.projects, metricsData.response, metricsData.sla],
          backgroundColor: 'rgba(0,200,255,0.6)',
          borderColor: 'rgba(0,200,255,1)',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          y: { beginAtZero: true, ticks: { color: '#dffbff' }, grid: { color: 'rgba(255,255,255,0.05)' } },
          x: { ticks: { color: '#dffbff' }, grid: { color: 'rgba(255,255,255,0.05)' } }
        },
        plugins: { legend: { labels: { color: '#dffbff' } } }
      }
    });
  }

  function updateCharts() {
    if (pieChart) {
      pieChart.data.datasets[0].data = [metricsData.satisfaction, metricsData.docs, metricsData.retention, metricsData.automation];
      pieChart.update();
    }
    if (barChart) {
      barChart.data.datasets[0].data = [metricsData.incidents, metricsData.projects, metricsData.response, metricsData.sla];
      barChart.update();
    }
  }

  document.querySelectorAll('.metric-field').forEach(input => {
    input.addEventListener('input', function() {
      const metric = this.dataset.metric;
      const value = parseFloat(this.value) || 0;
      metricsData[metric] = value;
      updateCharts();
    });
  });

  // ---------- Download / Export ----------
  document.getElementById('btn-print').addEventListener('click', ()=>{
    window.print();
  });

  document.getElementById('btn-export-json').addEventListener('click', ()=>{
    const data = {
      empresa: "Yachay Tech Solutions S.A.C.",
      sector: "IA / Cloud / Ciberseguridad",
      tamano: "200 colaboradores",
      objetivo: "PITDS - seguridad, mejora continua y gestión del conocimiento",
      metrics: metricsData,
      fases: {
        fase0: "Diagnóstico", fase1: "Gobernanza", fase2: "Planificacion",
        fase3: "Diseño", fase4: "Piloto", fase5: "Medición"
      },
      foda: {
        FO: ["E01 Expandir IA","E02 Cloud regional","E03 I+D universidades"],
        FA: ["E04 Retención","E05 SOC","E06 Auditorías"],
        DO: ["E07 ITSM","E08 CI/CD","E09 Repositorio"],
        DA: ["E10 Híbrida","E11 Cross-training","E12 Automatización"]
      }
    };
    const pre = document.getElementById('exportJsonArea');
    pre.style.display='block';
    pre.textContent = JSON.stringify(data, null, 2);
  });

  // Keyboard shortcuts
  document.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
      e.preventDefault();
      document.getElementById('toggle-edit').click();
    }
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
      e.preventDefault();
      document.getElementById('save-data').click();
    }
  });

  // Keyboard nav
  document.querySelectorAll('.nav button').forEach((b,i)=>{
    b.addEventListener('keydown', (e)=>{
      if (e.key === 'ArrowDown') {
        const next = document.querySelectorAll('.nav button')[i+1];
        next && next.focus();
      }
      if (e.key === 'ArrowUp') {
        const prev = document.querySelectorAll('.nav button')[i-1];
        prev && prev.focus();
      }
    });
  });
</script>
</body>
</html>